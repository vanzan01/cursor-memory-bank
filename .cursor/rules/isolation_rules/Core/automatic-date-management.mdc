---
description: "–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞—Ç–∞–º–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –≤ VAN —Ä–µ–∂–∏–º–µ"
globs: "**/memory-bank/**
alwaysApply: true
---

# AUTOMATIC DATE MANAGEMENT SYSTEM

> **TL;DR:** –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞—Ç–∞–º–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ VAN —Ä–µ–∂–∏–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ –≤–æ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö Memory Bank.

## üìÖ –ü–†–ò–ù–¶–ò–ü–´ –£–ü–†–ê–í–õ–ï–ù–ò–Ø –î–ê–¢–ê–ú–ò

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ VAN —Ä–µ–∂–∏–º–µ**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º–Ω–æ–π –¥–∞—Ç—ã –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ VAN
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ current-date.txt
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞—Ç—ã (YYYY-MM-DD)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞—Ç**
- –ó–∞–ø—Ä–µ—Ç –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ hardcoded –¥–∞—Ç
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –∑–∞–º–µ–Ω–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞—Ç
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞—Ç –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö

## üîÑ VAN –†–ï–ñ–ò–ú: –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—Ç—ã –ø—Ä–∏ –≤—Ö–æ–¥–µ
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç—ã –≤ VAN —Ä–µ–∂–∏–º–µ
van_check_and_update_date() {
  echo "üìÖ –ü–†–û–í–ï–†–ö–ê –ò –û–ë–ù–û–í–õ–ï–ù–ò–ï –î–ê–¢–´ –í VAN –†–ï–ñ–ò–ú–ï"
  echo "========================================="

  local current_system_date=$(date +%Y-%m-%d)
  local date_file="memory-bank/system/current-date.txt"

  echo "üïí –°–∏—Å—Ç–µ–º–Ω–∞—è –¥–∞—Ç–∞: $current_system_date"

  # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ –¥–∞—Ç—ã
  if [ ! -f "$date_file" ]; then
    echo "‚ùå –§–∞–π–ª –¥–∞—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω: $date_file"
    echo "üîß –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å —Ç–µ–∫—É—â–µ–π –¥–∞—Ç–æ–π"
    mkdir -p "$(dirname "$date_file")"
    echo "$current_system_date" > "$date_file"
    echo "‚úÖ –§–∞–π–ª –¥–∞—Ç—ã —Å–æ–∑–¥–∞–Ω: $date_file"
    return 0
  fi

  # –ß—Ç–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –¥–∞—Ç—ã
  local stored_date=$(cat "$date_file" 2>/dev/null | tr -d '\n\r' | head -1)
  echo "üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è –¥–∞—Ç–∞: $stored_date"

  # –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –¥–∞—Ç—ã
  if ! validate_date_format "$stored_date"; then
    echo "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –¥–∞—Ç—ã: $stored_date"
    echo "üîß –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞"
    echo "$current_system_date" > "$date_file"
    echo "‚úÖ –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ: $current_system_date"
    return 0
  fi

  # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∞—Ç
  if [ "$stored_date" = "$current_system_date" ]; then
    echo "‚úÖ –î–∞—Ç–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞: $stored_date"
  else
    echo "üîÑ –î–∞—Ç–∞ —É—Å—Ç–∞—Ä–µ–ª–∞, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: $stored_date ‚Üí $current_system_date"

    # –°–æ–∑–¥–∞–Ω–∏–µ backup —Å—Ç–∞—Ä–æ–π –¥–∞—Ç—ã
    backup_old_date "$stored_date" "$date_file"

    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—Ç—ã
    echo "$current_system_date" > "$date_file"
    echo "‚úÖ –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞: $current_system_date"

    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—Ç –≤ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
    update_related_dates "$stored_date" "$current_system_date"
  fi
}
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞—Ç—ã
```bash
# –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞—Ç—ã YYYY-MM-DD
validate_date_format() {
  local date_string="$1"

  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
  if ! echo "$date_string" | grep -qE '^[0-9]{4}-[0-9]{2}-[0-9]{2}$'; then
    return 1
  fi

  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –¥–∞—Ç—ã
  if date -d "$date_string" >/dev/null 2>&1; then
    return 0
  elif date -j -f "%Y-%m-%d" "$date_string" >/dev/null 2>&1; then
    # –î–ª—è macOS
    return 0
  else
    return 1
  fi
}

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
get_current_date() {
  date +%Y-%m-%d
}

# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞—Ç—ã —Å –≤—Ä–µ–º–µ–Ω–µ–º
get_current_datetime() {
  date +"%Y-%m-%d %H:%M:%S"
}

# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞—Ç—ã –¥–ª—è –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤
get_date_for_filename() {
  date +%Y%m%d
}
```

## üîç –û–ë–ù–ê–†–£–ñ–ï–ù–ò–ï –£–°–¢–ê–†–ï–í–®–ò–• –î–ê–¢

### –ü–æ–∏—Å–∫ hardcoded –¥–∞—Ç
```bash
# –ü–æ–∏—Å–∫ –∏ –∑–∞–º–µ–Ω–∞ hardcoded –¥–∞—Ç –≤ –ø—Ä–æ–µ–∫—Ç–µ
find_and_replace_hardcoded_dates() {
  local old_date="$1"
  local new_date="$2"
  local project_root="${3:-.}"

  echo "üîç –ü–û–ò–°–ö –£–°–¢–ê–†–ï–í–®–ò–• –î–ê–¢ –í –ü–†–û–ï–ö–¢–ï"
  echo "================================"

  # –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ —Å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏ –¥–∞—Ç–∞–º–∏
  local files_with_old_dates=$(grep -r "$old_date" "$project_root" --include="*.md" --include="*.txt" --include="*.yaml" --include="*.yml" --include="*.json" 2>/dev/null | cut -d: -f1 | sort -u)

  if [ -z "$files_with_old_dates" ]; then
    echo "‚úÖ –£—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
    return 0
  fi

  echo "üìã –§–∞–π–ª—ã —Å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏ –¥–∞—Ç–∞–º–∏:"
  echo "$files_with_old_dates"
  echo ""

  # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–º–µ–Ω—ã
  echo "üîÑ –ó–∞–º–µ–Ω–∏—Ç—å $old_date –Ω–∞ $new_date –≤–æ –≤—Å–µ—Ö –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö?"
  read -p "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (Y/n): " -n 1 -r
  echo

  if [[ ! $REPLY =~ ^[Nn]$ ]]; then
    local updated_files=0

    while IFS= read -r file; do
      if [ -f "$file" ]; then
        # –°–æ–∑–¥–∞–Ω–∏–µ backup
        cp "$file" "${file}.backup.$(date +%Y%m%d_%H%M%S)"

        # –ó–∞–º–µ–Ω–∞ –¥–∞—Ç
        if sed -i.tmp "s/$old_date/$new_date/g" "$file" 2>/dev/null; then
          rm -f "${file}.tmp"
          echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω: $file"
          ((updated_files++))
        else
          # –î–ª—è —Å–∏—Å—Ç–µ–º –≥–¥–µ sed -i —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ-–¥—Ä—É–≥–æ–º—É
          sed "s/$old_date/$new_date/g" "$file" > "${file}.tmp" && mv "${file}.tmp" "$file"
          echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω: $file"
          ((updated_files++))
        fi
      fi
    done <<< "$files_with_old_dates"

    echo "üéØ –û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: $updated_files"
  else
    echo "‚ùå –ó–∞–º–µ–Ω–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞"
  fi
}
```

### –ü–æ–∏—Å–∫ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–∞—Ç
```bash
# –ü–æ–∏—Å–∫ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–∞—Ç –≤ –ø—Ä–æ–µ–∫—Ç–µ
scan_date_patterns() {
  local project_root="${1:-.}"

  echo "üîç –°–ö–ê–ù–ò–†–û–í–ê–ù–ò–ï –ü–ê–¢–¢–ï–†–ù–û–í –î–ê–¢"
  echo "============================="

  # –†–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞
  local date_patterns=(
    '[0-9]{4}-[0-9]{2}-[0-9]{2}'          # YYYY-MM-DD
    '[0-9]{2}/[0-9]{2}/[0-9]{4}'          # MM/DD/YYYY
    '[0-9]{2}\.[0-9]{2}\.[0-9]{4}'        # DD.MM.YYYY
    '[0-9]{4}[0-9]{2}[0-9]{2}'            # YYYYMMDD
    '20[0-9]{2}-[0-9]{2}-[0-9]{2}'        # 2024-12-09 (–±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π)
  )

  for pattern in "${date_patterns[@]}"; do
    echo "üîç –ü–æ–∏—Å–∫ –ø–∞—Ç—Ç–µ—Ä–Ω–∞: $pattern"
    local matches=$(grep -r -E "$pattern" "$project_root" --include="*.md" --include="*.txt" --include="*.yaml" --include="*.yml" --include="*.json" 2>/dev/null | head -10)

    if [ -n "$matches" ]; then
      echo "üìã –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è:"
      echo "$matches"
      echo ""
    fi
  done
}
```

## üìù –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–í–Ø–ó–ê–ù–ù–´–• –§–ê–ô–õ–û–í

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—Ç –≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—Ç –≤ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö Memory Bank
update_related_dates() {
  local old_date="$1"
  local new_date="$2"

  echo "üîÑ –û–ë–ù–û–í–õ–ï–ù–ò–ï –î–ê–¢ –í –°–í–Ø–ó–ê–ù–ù–´–• –§–ê–ô–õ–ê–•"
  echo "===================================="

  # –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
  local files_to_update=(
    "memory-bank/tasks.md"
    "memory-bank/progress.md"
    "memory-bank/activeContext.md"
    "memory-bank/projectbrief.md"
  )

  local updated_count=0

  for file in "${files_to_update[@]}"; do
    if [ -f "$file" ]; then
      # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å—Ç–∞—Ä–æ–π –¥–∞—Ç—ã –≤ —Ñ–∞–π–ª–µ
      if grep -q "$old_date" "$file" 2>/dev/null; then
        echo "üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ: $file"

        # –°–æ–∑–¥–∞–Ω–∏–µ backup
        cp "$file" "${file}.backup.$(date +%Y%m%d_%H%M%S)"

        # –ó–∞–º–µ–Ω–∞ –¥–∞—Ç
        sed -i.tmp "s/$old_date/$new_date/g" "$file" 2>/dev/null || {
          sed "s/$old_date/$new_date/g" "$file" > "${file}.tmp" && mv "${file}.tmp" "$file"
        }
        rm -f "${file}.tmp"

        echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω: $file"
        ((updated_count++))
      fi
    fi
  done

  echo "üìä –û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: $updated_count"
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—Ç –≤ –∞—Ä—Ö–∏–≤–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞—Ç –≤ –∞—Ä—Ö–∏–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö
update_archive_dates() {
  local old_date="$1"
  local new_date="$2"

  echo "üìö –û–ë–ù–û–í–õ–ï–ù–ò–ï –î–ê–¢ –í –ê–†–•–ò–í–ù–´–• –§–ê–ô–õ–ê–•"
  echo "=================================="

  # –ü–æ–∏—Å–∫ –∞—Ä—Ö–∏–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
  local archive_files=$(find memory-bank/archive -name "*.md" 2>/dev/null)

  if [ -z "$archive_files" ]; then
    echo "‚ÑπÔ∏è –ê—Ä—Ö–∏–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"
    return 0
  fi

  local updated_archives=0

  while IFS= read -r file; do
    if grep -q "$old_date" "$file" 2>/dev/null; then
      echo "üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞: $file"

      # –°–æ–∑–¥–∞–Ω–∏–µ backup
      cp "$file" "${file}.backup.$(date +%Y%m%d_%H%M%S)"

      # –ó–∞–º–µ–Ω–∞ –¥–∞—Ç
      sed -i.tmp "s/$old_date/$new_date/g" "$file" 2>/dev/null || {
        sed "s/$old_date/$new_date/g" "$file" > "${file}.tmp" && mv "${file}.tmp" "$file"
      }
      rm -f "${file}.tmp"

      ((updated_archives++))
    fi
  done <<< "$archive_files"

  echo "üìä –û–±–Ω–æ–≤–ª–µ–Ω–æ –∞—Ä—Ö–∏–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤: $updated_archives"
}
```

## üîß –£–¢–ò–õ–ò–¢–´ –†–ê–ë–û–¢–´ –° –î–ê–¢–ê–ú–ò

### –í—ã—á–∏—Å–ª–µ–Ω–∏—è —Å –¥–∞—Ç–∞–º–∏
```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞—Ç—ã N –¥–Ω–µ–π –Ω–∞–∑–∞–¥
get_date_days_ago() {
  local days_ago="$1"

  if date -v -"${days_ago}d" +%Y-%m-%d 2>/dev/null; then
    # macOS
    return 0
  elif date -d "$days_ago days ago" +%Y-%m-%d 2>/dev/null; then
    # Linux
    return 0
  else
    echo "–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã—á–∏—Å–ª–∏—Ç—å –¥–∞—Ç—É" >&2
    return 1
  fi
}

# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞—Ç—ã N –¥–Ω–µ–π –≤–ø–µ—Ä–µ–¥
get_date_days_ahead() {
  local days_ahead="$1"

  if date -v +"${days_ahead}d" +%Y-%m-%d 2>/dev/null; then
    # macOS
    return 0
  elif date -d "$days_ahead days" +%Y-%m-%d 2>/dev/null; then
    # Linux
    return 0
  else
    echo "–û—à–∏–±–∫–∞: –ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã—á–∏—Å–ª–∏—Ç—å –¥–∞—Ç—É" >&2
    return 1
  fi
}

# –†–∞–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –¥–∞—Ç–∞–º–∏ –≤ –¥–Ω—è—Ö
get_date_difference() {
  local date1="$1"
  local date2="$2"

  local timestamp1 timestamp2

  if timestamp1=$(date -j -f "%Y-%m-%d" "$date1" +%s 2>/dev/null); then
    # macOS
    timestamp2=$(date -j -f "%Y-%m-%d" "$date2" +%s 2>/dev/null)
  elif timestamp1=$(date -d "$date1" +%s 2>/dev/null); then
    # Linux
    timestamp2=$(date -d "$date2" +%s 2>/dev/null)
  else
    echo "–û—à–∏–±–∫–∞: –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã" >&2
    return 1
  fi

  local diff_seconds=$((timestamp2 - timestamp1))
  local diff_days=$((diff_seconds / 86400))

  echo "$diff_days"
}
```

### –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç
```bash
# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ü–µ–ª–µ–π
format_date_for_purpose() {
  local date_string="$1"
  local purpose="$2"

  case "$purpose" in
    "filename")
      echo "$date_string" | tr -d '-'
      ;;
    "display")
      if date -j -f "%Y-%m-%d" "$date_string" "+%d %B %Y" 2>/dev/null; then
        # macOS
        return 0
      elif date -d "$date_string" "+%d %B %Y" 2>/dev/null; then
        # Linux
        return 0
      fi
      ;;
    "iso")
      echo "${date_string}T00:00:00Z"
      ;;
    "timestamp")
      if date -j -f "%Y-%m-%d" "$date_string" +%s 2>/dev/null; then
        # macOS
        return 0
      elif date -d "$date_string" +%s 2>/dev/null; then
        # Linux
        return 0
      fi
      ;;
    *)
      echo "$date_string"
      ;;
  esac
}
```

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –û–¢–ß–ï–¢–´

### –û—Ç—á–µ—Ç –æ –¥–∞—Ç–∞—Ö –≤ –ø—Ä–æ–µ–∫—Ç–µ
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –æ –¥–∞—Ç–∞—Ö –≤ –ø—Ä–æ–µ–∫—Ç–µ
generate_date_report() {
  local project_root="${1:-.}"
  local output_file="${2:-date_report.md}"

  echo "üìä –ì–ï–ù–ï–†–ê–¶–ò–Ø –û–¢–ß–ï–¢–ê –û –î–ê–¢–ê–•"
  echo "=========================="

  cat > "$output_file" << EOF
# –û—Ç—á–µ—Ç –æ –¥–∞—Ç–∞—Ö –≤ –ø—Ä–æ–µ–∫—Ç–µ

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–∞**: $(get_current_datetime)
**–°–∏—Å—Ç–µ–º–Ω–∞—è –¥–∞—Ç–∞**: $(get_current_date)
**–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è –¥–∞—Ç–∞**: $(cat memory-bank/system/current-date.txt 2>/dev/null || echo "–ù–µ –Ω–∞–π–¥–µ–Ω–∞")

## –ù–∞–π–¥–µ–Ω–Ω—ã–µ –¥–∞—Ç—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ

EOF

  # –ü–æ–∏—Å–∫ –≤—Å–µ—Ö –¥–∞—Ç –≤ –ø—Ä–æ–µ–∫—Ç–µ
  echo "üîç –ü–æ–∏—Å–∫ –¥–∞—Ç –≤ —Ñ–∞–π–ª–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞..."

  local all_dates=$(grep -r -h -E '[0-9]{4}-[0-9]{2}-[0-9]{2}' "$project_root" --include="*.md" --include="*.txt" --include="*.yaml" --include="*.yml" --include="*.json" 2>/dev/null | grep -oE '[0-9]{4}-[0-9]{2}-[0-9]{2}' | sort | uniq -c | sort -nr)

  if [ -n "$all_dates" ]; then
    echo "### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞—Ç" >> "$output_file"
    echo "" >> "$output_file"
    echo "\`\`\`" >> "$output_file"
    echo "$all_dates" >> "$output_file"
    echo "\`\`\`" >> "$output_file"
  fi

  # –ü–æ–∏—Å–∫ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞—Ç
  local current_date=$(get_current_date)
  local outdated_dates=$(echo "$all_dates" | awk -v current="$current_date" '$2 < current {print $2}')

  if [ -n "$outdated_dates" ]; then
    echo "" >> "$output_file"
    echo "### ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞—Ç—ã" >> "$output_file"
    echo "" >> "$output_file"
    echo "$outdated_dates" | while read date; do
      echo "- $date" >> "$output_file"
    done
  fi

  echo "‚úÖ –û—Ç—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω: $output_file"
}
```

### Backup —Å—Ç–∞—Ä—ã—Ö –¥–∞—Ç
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ backup —Å—Ç–∞—Ä–æ–π –¥–∞—Ç—ã
backup_old_date() {
  local old_date="$1"
  local date_file="$2"
  local backup_dir="memory-bank/backup/dates"

  mkdir -p "$backup_dir"

  local backup_file="$backup_dir/date_backup_$(date +%Y%m%d_%H%M%S).txt"

  cat > "$backup_file" << EOF
# Backup –¥–∞—Ç—ã
–°—Ç–∞—Ä–∞—è –¥–∞—Ç–∞: $old_date
–ù–æ–≤–∞—è –¥–∞—Ç–∞: $(get_current_date)
–í—Ä–µ–º—è backup: $(get_current_datetime)
–ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª: $date_file
EOF

  echo "üíæ Backup —Å–æ–∑–¥–∞–Ω: $backup_file"
}
```

## üö® –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã—Ö –¥–∞—Ç
```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–∞—Ç—ã
recover_date_file() {
  local date_file="memory-bank/system/current-date.txt"
  local backup_dir="memory-bank/backup/dates"

  echo "üîß –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –§–ê–ô–õ–ê –î–ê–¢–´"
  echo "============================"

  # –ü–æ–∏—Å–∫ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ backup
  local latest_backup=$(find "$backup_dir" -name "date_backup_*.txt" 2>/dev/null | sort | tail -1)

  if [ -n "$latest_backup" ]; then
    echo "üìÅ –ù–∞–π–¥–µ–Ω backup: $latest_backup"
    local backup_date=$(grep "–°—Ç–∞—Ä–∞—è –¥–∞—Ç–∞:" "$latest_backup" | cut -d' ' -f3)

    if validate_date_format "$backup_date"; then
      echo "‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup: $backup_date"
      echo "$backup_date" > "$date_file"
    else
      echo "‚ùå Backup —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –¥–∞—Ç—É"
      echo "üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Å–∏—Å—Ç–µ–º–Ω–æ–π –¥–∞—Ç—ã"
      echo "$(get_current_date)" > "$date_file"
    fi
  else
    echo "‚ùå Backup –Ω–µ –Ω–∞–π–¥–µ–Ω"
    echo "üîß –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ —Å —Ç–µ–∫—É—â–µ–π –¥–∞—Ç–æ–π"
    mkdir -p "$(dirname "$date_file")"
    echo "$(get_current_date)" > "$date_file"
  fi

  echo "‚úÖ –§–∞–π–ª –¥–∞—Ç—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
}
```

–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞—Ç–∞–º–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ –≤–æ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö Memory Bank –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö hardcoded –¥–∞—Ç.