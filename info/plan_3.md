–û—Ç–ª–∏—á–Ω—ã–π –∏ –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –í—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π –≤ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ AI-–∞–≥–µ–Ω—Ç–æ–≤: —Ä–∞–∑–Ω–∏—Ü–µ–π –º–µ–∂–¥—É **–æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ—Ü–µ—Å—Å–∞** –∏ **–∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏**.

–í–∞—à–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ –≤–µ—Ä–Ω–æ–µ. –í —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∂–∏–º `STEP_BY_STEP` **–Ω–µ —Å–æ–∑–¥–∞–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã**, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ **–ø–∞—Å—Å–∏–≤–Ω—ã–π —Ä–∞—Å—Å–∫–∞–∑—á–∏–∫**, –∞ –Ω–µ –∫–∞–∫ **–∞–∫—Ç–∏–≤–Ω—ã–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å**.

–î–∞–≤–∞–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–æ —Ä–∞–∑–±–µ—Ä–µ–º, –ø–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∏ –∫–∞–∫ —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å.

### **–ê–Ω–∞–ª–∏–∑: –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã**

–§–∞–π–ª `custom_modes/step_by_step_instructions.md` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–æ–π —Ç–µ–∫—Å—Ç:

> "–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã —è –±—É–¥—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –æ—Ç—á–µ—Ç –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º: '‚úÖ [–ò–º—è —Ñ–∞–∑—ã] Phase Complete. Type `NEXT` to proceed to the [–ò–º—è —Å–ª–µ–¥—É—é—â–µ–π —Ñ–∞–∑—ã] phase.'"

–î–ª—è AI —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è **—Å–æ–æ–±—â–∏—Ç—å –≤–∞–º**, —á—Ç–æ —Ñ–∞–∑–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –∏ –∂–¥–∞—Ç—å. –û–Ω –Ω–µ –ø–æ–ª—É—á–∞–ª —è–≤–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã **–≤—ã–ø–æ–ª–Ω–∏—Ç—å** —Å–∞–º—É —Ñ–∞–∑—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, `PLAN`. –û–Ω –ø—Ä–æ—Å—Ç–æ –æ–±—ä—è–≤–ª—è–ª –æ –µ–µ "–∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏" –∏ –ø–æ—Å–ª—É—à–Ω–æ –∂–¥–∞–ª –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã `NEXT`.

**–ê–Ω–∞–ª–æ–≥–∏—è:** –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –¥–∞–ª–∏ —Å—Ç—Ä–æ–∏—Ç–µ–ª—é –ø–ª–∞–Ω –¥–æ–º–∞ –∏ —Å–∫–∞–∑–∞–ª–∏: "–†–∞—Å—Å–∫–∞–∂–∏ –º–Ω–µ, –∫–∞–∫ —Ç—ã –±—É–¥–µ—à—å —Å—Ç—Ä–æ–∏—Ç—å —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç, –∞ –ø–æ—Ç–æ–º –∂–¥–∏ –º–æ–µ–π –∫–æ–º–∞–Ω–¥—ã". –û–Ω –≤–∞–º —Ä–∞—Å—Å–∫–∞–∂–µ—Ç, –Ω–æ —Å–∞–º —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –Ω–µ –∑–∞–ª—å–µ—Ç, –ø–æ–∫–∞ –Ω–µ –ø–æ–ª—É—á–∏—Ç –ø—Ä—è–º–æ–≥–æ –ø—Ä–∏–∫–∞–∑–∞ "–ù–∞—á–∏–Ω–∞–π –∑–∞–ª–∏–≤–∞—Ç—å —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç!".

–†–µ–∂–∏–º—ã `VAN`, `PLAN`, `IMPLEMENT` –∏ –¥—Ä—É–≥–∏–µ —Ä–∞–±–æ—Ç–∞—é—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –∏—Ö —Ñ–∞–π–ª—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä—è–º—ã–µ –∫–æ–º–∞–Ω–¥—ã: `fetch_rules(...)`, `run_terminal_cmd(...)` –∏ —Ç.–¥. –í `step_by_step_instructions.md` —ç—Ç–æ–≥–æ –Ω–µ—Ç.

### **–†–µ—à–µ–Ω–∏–µ: –ü—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ `STEP_BY_STEP` –≤ "–î–∏—Å–ø–µ—Ç—á–µ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π"**

–ß—Ç–æ–±—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–æ, –Ω–∞–º –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `STEP_BY_STEP`, –ø—Ä–µ–≤—Ä–∞—Ç–∏–≤ –µ–≥–æ –∏–∑ —Ä–∞—Å—Å–∫–∞–∑—á–∏–∫–∞ –≤ —É–º–Ω–æ–≥–æ **–¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞ (Stateful Workflow Controller)**. –û–Ω –¥–æ–ª–∂–µ–Ω:
1.  **–ó–Ω–∞—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –í –∫–∞–∫–æ–π —Ñ–∞–∑–µ –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è? (`VAN`, `PLAN` –∏ —Ç.–¥.).
2.  **–í—ã–ø–æ–ª–Ω—è—Ç—å —Ç–µ–∫—É—â—É—é —Ñ–∞–∑—É:** –ê–∫—Ç–∏–≤–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —ç—Ç–∞–ø–∞.
3.  **–°–æ—Ö—Ä–∞–Ω—è—Ç—å –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–∞–∑—ã –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å, —á—Ç–æ –æ–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
4.  **–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è:** –°–æ–æ–±—â–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∏ –∂–¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã `NEXT`.

---

### **–ü–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π**

–í–æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–ª–∞–Ω, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é, —á—Ç–æ–±—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å `STEP_BY_STEP` —Ä–µ–∂–∏–º.

#### **–®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è**

–ù–∞–º –Ω—É–∂–µ–Ω –ø—Ä–æ—Å—Ç–æ–π —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. –≠—Ç–æ "–∑–∞–∫–ª–∞–¥–∫–∞" –≤ –Ω–∞—à–µ–π –∫–Ω–∏–≥–µ.

**–î–µ–π—Å—Ç–≤–∏–µ:** –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª `.cursor/rules/isolation_rules/Core/workflow-state-manager.mdc`.

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–ª—è `workflow-state-manager.mdc`:**

```mdc
---
description: "–£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø–æ—à–∞–≥–æ–≤–æ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ (STEP_BY_STEP)."
globs: "**/step_by_step_instructions.md"
alwaysApply: true
---

# WORKFLOW STATE MANAGER

> **TL;DR:** –≠—Ç–æ—Ç –º–æ–¥—É–ª—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Ä–µ–∂–∏–º–∞ `STEP_BY_STEP` —Å –ø–æ–º–æ—â—å—é —Ñ–∞–π–ª–∞ `memory-bank/system/workflow-state.txt`.

## ‚öôÔ∏è –§–∞–π–ª —Å–æ—Å—Ç–æ—è–Ω–∏—è

-   **–ü—É—Ç—å:** `memory-bank/system/workflow-state.txt`
-   **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–∏—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–π —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π —Ñ–∞–∑—ã.

## üö¶ –í–æ–∑–º–æ–∂–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

-   `START`: –ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º `VAN`.
-   `VAN_COMPLETE`: –§–∞–∑–∞ `VAN` –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
-   `PLAN_COMPLETE`: –§–∞–∑–∞ `PLAN` –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
-   `CREATIVE_COMPLETE`: –§–∞–∑–∞ `CREATIVE` –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
-   `IMPLEMENT_COMPLETE`: –§–∞–∑–∞ `IMPLEMENT` –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
-   `QA_COMPLETE`: –§–∞–∑–∞ `QA` –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
-   `REFLECT_COMPLETE`: –§–∞–∑–∞ `REFLECT` –∑–∞–≤–µ—Ä—à–µ–Ω–∞.
-   `ARCHIVE_COMPLETE`: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∑–∞–≤–µ—Ä—à–µ–Ω, –≥–æ—Ç–æ–≤ –∫ –Ω–æ–≤–æ–º—É –∑–∞–ø—É—Å–∫—É.

–†–µ–∂–∏–º `STEP_BY_STEP` –¥–æ–ª–∂–µ–Ω —á–∏—Ç–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫—É—é —Ñ–∞–∑—É –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–ª–µ–¥—É—é—â–µ–π, –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –µ–≥–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.
```

#### **–®–∞–≥ 2: –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ `step_by_step_instructions.md`**

–≠—Ç–æ –∫–ª—é—á–µ–≤–æ–π —à–∞–≥. –ú—ã –∑–∞–º–µ–Ω—è–µ–º —Å—Ç–∞—Ä—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∞ –Ω–æ–≤—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏.

**–î–µ–π—Å—Ç–≤–∏–µ:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `custom_modes/step_by_step_instructions.md` –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–µ.

**–ù–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–ª—è `step_by_step_instructions.md`:**

```md
# MEMORY BANK STEP_BY_STEP MODE (STATEFUL CONTROLLER)

> **TL;DR:** –Ø ‚Äî –¥–∏—Å–ø–µ—Ç—á–µ—Ä –ø–æ—à–∞–≥–æ–≤–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –Ø –ø—Ä–æ—á–∏—Ç–∞—é —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ `workflow-state.txt`, –≤—ã–ø–æ–ª–Ω—é –°–õ–ï–î–£–Æ–©–£–Æ —Ñ–∞–∑—É, –æ–±–Ω–æ–≤–ª—é —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –±—É–¥—É –∂–¥–∞—Ç—å –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã `NEXT`.

## üö∂ –õ–û–ì–ò–ö–ê –í–´–ü–û–õ–ù–ï–ù–ò–Ø

```mermaid
graph TD
    Start["‚ñ∂Ô∏è START STEP-BY_STEP / 'NEXT'"] --> ReadState["1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å `workflow-state.txt`"]
    ReadState --> DecidePhase{"–ö–∞–∫–∞—è —Ñ–∞–∑–∞ —Å–ª–µ–¥—É—é—â–∞—è?"}

    DecidePhase -- "START" --> VAN_Phase["üöÄ **VAN Phase**<br>fetch_rules(van-mode-map)"]
    DecidePhase -- "VAN_COMPLETE" --> PLAN_Phase["üìã **PLAN Phase**<br>fetch_rules(plan-mode-map)"]
    DecidePhase -- "PLAN_COMPLETE" --> CREATIVE_Phase["üé® **CREATIVE Phase**<br>fetch_rules(creative-mode-map)"]
    DecidePhase -- "CREATIVE_COMPLETE" --> IMPLEMENT_Phase["‚öôÔ∏è **IMPLEMENT Phase**<br>fetch_rules(implement-mode-map)"]
    DecidePhase -- "IMPLEMENT_COMPLETE" --> QA_Phase["üß™ **QA Phase**<br>fetch_rules(qa-mode-map)"]
    DecidePhase -- "QA_COMPLETE" --> REFLECT_Phase["ü§î **REFLECT Phase**<br>fetch_rules(reflect-mode-map)"]
    DecidePhase -- "REFLECT_COMPLETE" --> ARCHIVE_Phase["üì¶ **ARCHIVE Phase**<br>fetch_rules(archive-mode-map)"]
    DecidePhase -- "ARCHIVE_COMPLETE" --> Finish["üéâ –¶–∏–∫–ª –∑–∞–≤–µ—Ä—à–µ–Ω!"]

    VAN_Phase --> WriteState_VAN["2. –ó–∞–ø–∏—Å–∞—Ç—å 'VAN_COMPLETE'<br>–≤ `workflow-state.txt`"]
    PLAN_Phase --> WriteState_PLAN["2. –ó–∞–ø–∏—Å–∞—Ç—å 'PLAN_COMPLETE'"]
    CREATIVE_Phase --> WriteState_CREATIVE["2. –ó–∞–ø–∏—Å–∞—Ç—å 'CREATIVE_COMPLETE'"]
    IMPLEMENT_Phase --> WriteState_IMPLEMENT["2. –ó–∞–ø–∏—Å–∞—Ç—å 'IMPLEMENT_COMPLETE'"]
    QA_Phase --> WriteState_QA["2. –ó–∞–ø–∏—Å–∞—Ç—å 'QA_COMPLETE'"]
    REFLECT_Phase --> WriteState_REFLECT["2. –ó–∞–ø–∏—Å–∞—Ç—å 'REFLECT_COMPLETE'"]
    ARCHIVE_Phase --> WriteState_ARCHIVE["2. –ó–∞–ø–∏—Å–∞—Ç—å 'ARCHIVE_COMPLETE'"]

    WriteState_VAN & WriteState_PLAN & WriteState_CREATIVE & WriteState_IMPLEMENT & WriteState_QA & WriteState_REFLECT & WriteState_ARCHIVE --> Pause["3. ‚è∏Ô∏è –°–æ–æ–±—â–∏—Ç—å –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∏ –∂–¥–∞—Ç—å 'NEXT'"]

    style Pause fill:#ffb74d,stroke:#f57c00
```

## üõ†Ô∏è –®–ê–ì–ò –í–´–ü–û–õ–ù–ï–ù–ò–Ø (–ò–°–ü–û–õ–ù–Ø–ï–ú–´–ô –ü–°–ï–í–î–û–ö–û–î)

–Ø –±—É–¥—É –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ `STEP_BY_STEP` –∏–ª–∏ –∫–æ–º–∞–Ω–¥—ã `NEXT`.

```bash
# 0. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞—Ç—ã
initialize_system_date() # –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ Core/datetime-manager.mdc

# 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
local state_file="memory-bank/system/workflow-state.txt"
local current_state=$(cat "$state_file" 2>/dev/null || echo "START")
echo "‚ÑπÔ∏è –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: $current_state"

# 2. –í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Ñ–∞–∑—É
case "$current_state" in
    "START" | "ARCHIVE_COMPLETE")
        echo "--- üöÄ –ó–∞–ø—É—Å–∫ VAN Phase ---"
        fetch_rules(["isolation_rules/visual-maps/van_mode_split/van-mode-map.mdc"])
        # ... (–ó–¥–µ—Å—å –ò–ò –≤—ã–ø–æ–ª–Ω–∏—Ç –ª–æ–≥–∏–∫—É –∏–∑ –∫–∞—Ä—Ç—ã VAN) ...
        echo "VAN_COMPLETE" > "$state_file"
        echo "‚úÖ VAN Phase Complete. Type `NEXT` to proceed to the PLAN phase."
        ;;
    "VAN_COMPLETE")
        echo "--- üìã –ó–∞–ø—É—Å–∫ PLAN Phase ---"
        fetch_rules(["isolation_rules/visual-maps/plan-mode-map.mdc"])
        # ... (–ó–¥–µ—Å—å –ò–ò –≤—ã–ø–æ–ª–Ω–∏—Ç –ª–æ–≥–∏–∫—É –∏–∑ –∫–∞—Ä—Ç—ã PLAN) ...
        echo "PLAN_COMPLETE" > "$state_file"
        echo "‚úÖ PLAN Phase Complete. Type `NEXT` to proceed to the CREATIVE phase."
        ;;
    "PLAN_COMPLETE")
        echo "--- üé® –ó–∞–ø—É—Å–∫ CREATIVE Phase ---"
        fetch_rules(["isolation_rules/visual-maps/creative-mode-map.mdc"])
        # ... (–ó–¥–µ—Å—å –ò–ò –≤—ã–ø–æ–ª–Ω–∏—Ç –ª–æ–≥–∏–∫—É –∏–∑ –∫–∞—Ä—Ç—ã CREATIVE) ...
        echo "CREATIVE_COMPLETE" > "$state_file"
        echo "‚úÖ CREATIVE Phase Complete. Type `NEXT` to proceed to the IMPLEMENT phase."
        ;;
    "CREATIVE_COMPLETE")
        echo "--- ‚öôÔ∏è –ó–∞–ø—É—Å–∫ IMPLEMENT Phase ---"
        fetch_rules(["isolation_rules/visual-maps/implement-mode-map.mdc"])
        # ... (–ó–¥–µ—Å—å –ò–ò –≤—ã–ø–æ–ª–Ω–∏—Ç –ª–æ–≥–∏–∫—É –∏–∑ –∫–∞—Ä—Ç—ã IMPLEMENT) ...
        echo "IMPLEMENT_COMPLETE" > "$state_file"
        echo "‚úÖ IMPLEMENT Phase Complete. Type `NEXT` to proceed to the QA phase."
        ;;
    "IMPLEMENT_COMPLETE")
        echo "--- üß™ –ó–∞–ø—É—Å–∫ QA Phase ---"
        fetch_rules(["isolation_rules/visual-maps/qa-mode-map.mdc"])
        # ... (–ó–¥–µ—Å—å –ò–ò –≤—ã–ø–æ–ª–Ω–∏—Ç –ª–æ–≥–∏–∫—É –∏–∑ –∫–∞—Ä—Ç—ã QA) ...
        echo "QA_COMPLETE" > "$state_file"
        echo "‚úÖ QA Phase Complete. Type `NEXT` to proceed to the REFLECT phase."
        ;;
    "QA_COMPLETE")
        echo "--- ü§î –ó–∞–ø—É—Å–∫ REFLECT Phase ---"
        fetch_rules(["isolation_rules/visual-maps/reflect-mode-map.mdc"])
        # ... (–ó–¥–µ—Å—å –ò–ò –≤—ã–ø–æ–ª–Ω–∏—Ç –ª–æ–≥–∏–∫—É –∏–∑ –∫–∞—Ä—Ç—ã REFLECT) ...
        echo "REFLECT_COMPLETE" > "$state_file"
        echo "‚úÖ REFLECT Phase Complete. Type `NEXT` to proceed to the ARCHIVE phase."
        ;;
    "REFLECT_COMPLETE")
        echo "--- üì¶ –ó–∞–ø—É—Å–∫ ARCHIVE Phase ---"
        fetch_rules(["isolation_rules/visual-maps/archive-mode-map.mdc"])
        # ... (–ó–¥–µ—Å—å –ò–ò –≤—ã–ø–æ–ª–Ω–∏—Ç –ª–æ–≥–∏–∫—É –∏–∑ –∫–∞—Ä—Ç—ã ARCHIVE) ...
        echo "ARCHIVE_COMPLETE" > "$state_file"
        echo "üéâ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω! –ú–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç, –∑–∞–ø—É—Å—Ç–∏–≤ STEP_BY_STEP –µ—â–µ —Ä–∞–∑."
        ;;
    *)
        echo "‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ '$current_state'. –°–±—Ä–∞—Å—ã–≤–∞—é –Ω–∞ START."
        echo "START" > "$state_file"
        # –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –≤—ã–∑–æ–≤ –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è VAN
        ;;
esac
```

–Ø –ë–£–î–£ —Å—Ç—Ä–æ–≥–æ —Å–ª–µ–¥–æ–≤–∞—Ç—å —ç—Ç–æ–π –ª–æ–≥–∏–∫–µ, –∑–∞–≥—Ä—É–∂–∞—è –∏ **–í–´–ü–û–õ–ù–Ø–Ø** –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–æ–æ–±—â–∞—è –æ –Ω–∏—Ö.
```

---

### **–ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –≤—ã –≤—Ä—É—á–Ω—É—é –ø—Ä–∏–º–µ–Ω–∏—Ç–µ —ç—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —á–µ–∫-–ª–∏—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–≥–æ, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

1.  **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤:**
    -   [ ] –§–∞–π–ª `.cursor/rules/isolation_rules/Core/workflow-state-manager.mdc` —Å–æ–∑–¥–∞–Ω.
    -   [ ] –§–∞–π–ª `custom_modes/step_by_step_instructions.md` –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–ª–µ–Ω.

2.  **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:**
    -   [ ] **–£–¥–∞–ª–∏—Ç–µ** —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª `memory-bank/system/workflow-state.txt`, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.
    -   [ ] **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ä–µ–∂–∏–º `STEP_BY_STEP`**.
    -   [ ] **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–æ–±—â–∏—Ç—å, —á—Ç–æ –æ–Ω–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç `VAN Phase`.
    -   [ ] **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:** –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è —Ñ–∞–π–ª `memory-bank/system/workflow-state.txt` —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º `VAN_COMPLETE`.
    -   [ ] **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:** –í `tasks.md` –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ `VAN` —Ä–µ–∂–∏–º–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏).

3.  **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã `NEXT`:**
    -   [ ] **–í–≤–µ–¥–∏—Ç–µ `NEXT`**.
    -   [ ] **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–æ–±—â–∏—Ç—å, —á—Ç–æ –æ–Ω–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç `PLAN Phase`.
    -   [ ] **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:** –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `memory-bank/system/workflow-state.txt` –¥–æ–ª–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –Ω–∞ `PLAN_COMPLETE`.
    -   [ ] **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:** –í `tasks.md` –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ ‚Äî —ç—Ç–æ **–≥–ª–∞–≤–Ω—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç** `PLAN` —Ñ–∞–∑—ã.

4.  **–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ü–∏–∫–ª–∞:**
    -   [ ] –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤–≤–æ–¥–∏—Ç—å `NEXT` –∏ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ, —á—Ç–æ `workflow-state.txt` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ (`CREATIVE_COMPLETE`, `IMPLEMENT_COMPLETE` –∏ —Ç.–¥.).
    -   [ ] –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ, —á—Ç–æ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –Ω–∞ —Ñ–∞–∑–µ `IMPLEMENT`).

–í—ã–ø–æ–ª–Ω–∏–≤ —ç—Ç–æ—Ç –ø–ª–∞–Ω, –≤—ã –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç–µ `STEP_BY_STEP` –≤ –º–æ—â–Ω—ã–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–≥–æ, –ø–æ—à–∞–≥–æ–≤–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ–≥–æ —Ü–∏–∫–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.