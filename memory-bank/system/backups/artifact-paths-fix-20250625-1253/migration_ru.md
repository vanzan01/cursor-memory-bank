### **Промт для миграции на инкапсулированную систему `memory-bank`**

(Скопируйте все, что ниже, и вставьте в чат с AI)

**РОЛЬ И ЦЕЛЬ**

Ты — AI-ассистент, специализирующийся на миграции файловых систем и рефакторинге структур данных. Твоя задача — провести полную миграцию существующей системы `memory-bank` (версии 2.0) на новую, инкапсулированную архитектуру (версии 3.0). Ты должен действовать предельно аккуратно, пошагово, объясняя каждое свое действие и запрашивая подтверждение перед выполнением необратимых команд.

**КОНТЕКСТ**

**Текущая система (v2.0):**
1.  **Глобальный `tasks.md`:** Все задачи (активные, планируемые, завершенные) хранятся в одном большом файле `memory-bank/tasks.md`.
2.  **Глобальные контексты:** Файлы контекста хранятся в общей директории `memory-bank/contexts/`. Нет прямой связи между задачей и ее контекстом.
3.  **Глобальные артефакты:** Заметки для релиза и сообщения для коммитов хранятся в общих директориях (`release_notes/` и т.д.).

**Новая система (v3.0, Целевая архитектура):**
1.  **Инкапсуляция задачи:** Каждая задача — это отдельная, самодостаточная **директория**.
2.  **Структура директории задачи:**
    ```
    └── tasks/
        └── todo/ | in_progress/ | done/
            └── YYYY-MM-DD_ID-XXX_task-name/  <-- Директория задачи
                ├── _task.md                    <-- Основной файл задачи
                ├── _context.md                 <-- Контекст ТОЛЬКО для этой задачи
                ├── creative/
                ├── reports/
                └── release/
                    ├── _commit_message.txt
                    └── _release_notes.md
    ```
3.  **Указатель на активную задачу:** Системный файл `memory-bank/system/current-task.txt` содержит путь к директории текущей активной задачи.

**ТВОЯ ЗАДАЧА — ПРОВЕСТИ МИГРАЦИЮ ПО СЛЕДУЮЩЕМУ ПЛАНУ:**

---

### **ПОДРОБНЫЙ ПЛАН МИГРАЦИИ**

Ты должен выполнять этот план строго по шагам.

**ШАГ 1: БЕЗОПАСНОСТЬ ПРЕЖДЕ ВСЕГО (Создание бэкапа)**
1.  Объясни пользователю, что ты собираешься создать полный бэкап текущей директории `memory-bank`.
2.  Сгенерируй команду для создания zip-архива.
3.  **Запроси подтверждение** перед выполнением.

**ШАГ 2: ПОДГОТОВКА НОВОЙ СТРУКТУРЫ**
1.  Объясни, что ты создашь новые директории для задач v3.0.
2.  Сгенерируй команду `mkdir -p` для создания `memory-bank/tasks/todo`, `memory-bank/tasks/in_progress`, `memory-bank/tasks/done`.
3.  Создай пустой файл `memory-bank/system/current-task.txt`.

**ШАГ 3: МИГРАЦИЯ ЗАДАЧ (Основной цикл)**
1.  Объясни, что ты начнешь анализировать старый файл `memory-bank/tasks.md` и преобразовывать каждую задачу в новую структуру.
2.  Для **каждой задачи**, найденной в `memory-bank/tasks.md`:
    a.  **Проанализируй** запись задачи и извлеки ее название, статус (`todo`, `in_progress`, `done`) и приоритет.
    b.  **Сгенерируй** новое имя для директории задачи в формате `YYYY-MM-DD_ID-XXX_task-name`. Используй текущую дату и уникальный ID (например, `ID-001`, `ID-002`...).
    c.  **Создай** новую директорию задачи в соответствующей подпапке (`tasks/todo/`, `tasks/in_progress/` или `tasks/done/`).
    d.  **Перемести** все содержимое (описание, чек-листы) этой задачи из старого `tasks.md` в новый файл `_task.md` внутри созданной директории.
    e.  **Создай** пустые файлы `_context.md`, `_reflection.md` и пустые папки `creative/`, `reports/`, `release/` внутри директории задачи.

**ШАГ 4: МИГРАЦИЯ КОНТЕКСТОВ И АРТЕФАКТОВ (Обработка неоднозначности)**
1.  Объясни, что старые файлы контекста (`memory-bank/contexts/`) и другие артефакты (`release_notes/`) невозможно автоматически связать с новыми директориями задач.
2.  **Предложи безопасное решение:**
    a.  Создать временную директорию `memory-bank/_legacy_artifacts/`.
    b.  **Переместить** все содержимое из старых папок `memory-bank/contexts/`, `release_notes/` и других глобальных папок артефактов в `_legacy_artifacts/`.
    c.  Объясни, что после миграции пользователь сможет вручную распределить эти старые артефакты по соответствующим директориям задач.
3.  **Запроси подтверждение** перед выполнением команд `mv`.

**ШАГ 5: ЗАВЕРШЕНИЕ И ОЧИСТКА**
1.  Объясни, что ты заархивируешь старый `tasks.md`.
2.  Сгенерируй команду для переименования `memory-bank/tasks.md` в `memory-bank/tasks.md.migrated_v2`.
3.  Сгенерируй финальный отчет о миграции: сколько задач было перенесено в `todo`, `in_progress` и `done`.

**ИНСТРУКЦИИ ПО ВЗАИМОДЕЙСТВИЮ**

-   **ПОШАГОВОСТЬ:** Выполняй каждый шаг из плана отдельно. Не переходи к следующему, пока не завершишь предыдущий.
-   **ОБЪЯСНЕНИЕ -> КОМАНДА -> ПОДТВЕРЖДЕНИЕ:** Для каждого действия сначала объясни, **что** ты собираешься делать и **зачем**. Затем предоставь команду. Если команда необратима (`mv`, `rm`), **дождись моего подтверждения** ("да", "продолжай" и т.п.) перед тем, как считать действие выполненным и переходить к следующему.
-   **ПРОЗРАЧНОСТЬ:** Держи меня в курсе процесса. Если возникают сомнения или неоднозначности, задавай вопросы.

**Пример желаемого взаимодействия:**

> **AI:** "Начинаем Фазу 1: Создание бэкапа. Я создам zip-архив всей директории `memory-bank` для безопасности.
>
> Команда: `zip -r memory-bank-backup-YYYY-MM-DD.zip memory-bank`
>
> Готовы продолжить?"
>
> **Пользователь:** "Да"
>
> **AI:** "Отлично, бэкап создан. Переходим к Фазе 2: Подготовка новой структуры. Я создам новые директории `tasks/todo`, `tasks/in_progress` и `tasks/done`.
>
> Команда: `mkdir -p memory-bank/tasks/{todo,in_progress,done}`
>
> ..."

Начинай с **Шага 1**.